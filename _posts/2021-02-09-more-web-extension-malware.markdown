---
layout: single
categories: jekyll update
toc: true
---
# Details
Web browser extensions are one of the most prevalent forms malware distribution. This is quite strange considering that extensions are sandboxed from the rest off the computer and must operate within the browser’s permission system. Despite these restrictions, the allure of harvesting a user’s web data is impossible to avoid. An affected user may be able to directly generate clicks, therefore money, or their data can be harvested, sold, and abused.  The nice thing about finding browser extensions containing malware is that the code of any web extension is viewable. The problem is that there are simply too many extensions to perform security audits on. There is also the issue that a trusted extension may update at any time becoming a vector for malware. 

In December 2020, Avast disclosed details of several web extensions that while functional, were also acting as a vector for malware. Most of these extensions were labeled as video downloaders. While the attack was not groundbreaking it combined several techniques to remain undetected for at least 3 years. Once compromised a user’s clicks could be hijacked and search results modified. Certain information from google could also be stolen, but this seems to be exclusive to Google. 
# Opinion
I found this attack to be nothing different than many other attacks. The extension did something but was also able to execute arbitrary code that was hosted externally. Everything meaningful was either obfuscated, encrypted, or hosted remotely. This is perhaps interesting if you are a malware analyst. For me, the interesting aspect is that it took 3 years for someone to audit this extension. Every extension on a browser’s web store needs to be audited regularly.  This means that most browser extensions on a browser’s extension store need to die. Many extensions do very little for the user, are duplicates of other extensions, or contain malware. Nuking the web extension store may be harsh for developers, but for users it will free up resources that can be used to perform security audits for useful extension. If advanced users wish to download extensions not from the extension store, they can side load them or use something like Tampermonkey scripts. Users cannot be relied on to use only trusted extensions. Making them sideload untrusted extensions may give the user more time to consider what they are doing is risky. At the very least it is not the browser extension store aggregating malware. 

If browsers are left so open, users need to be entrusted with their own security. This involves using a good, usually paid for, malware protection software, reading extension permissions, and use only trusted extensions. The catch-all being that none of these are full-proof. Users can still be infected if they are running code that is not audited. 

# Sources
* [Decoded avast.io](https://decoded.avast.io/janvojtesek/backdoored-browser-extensions-hid-malicious-traffic-in-analytics-requests/)
* [The Daily Swig](https://portswigger.net/daily-swig/cacheflow-malware-hidden-in-popular-browser-extensions-went-undetected-for-years)